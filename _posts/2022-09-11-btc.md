---
layout: post
title:  "Bitcoin Price Tracker"
date:   2022-09-11 15:39:40
preview: img/posts/2022-09-11-btc/preview.webp
---
I thought it would be interesting to track the price of bitcoin in different national currencies over time. In particular, I wanted a way to quickly see when the last all-time high (ATH) price occured in a given currency, and compare that ATH with the current price. Most of the time, all national currencies move in the same way against bitcoin. But sometimes, my spreadsheet will show a national currency that performing less well than others against bitcoin. In the last couple of years, examples of countries whose currencies have suffered severe devaluation include Lebanon, Venezuela and Argentina

I ended up using the CoinGecko API to access price data, the Google Sheets API to update a public spreadsheet, and AWS Lambda to automate the script to run every ten minutes.



The script starts by importing the various libraries I will need, in particular `pandas` for data manipulation, and `gsspread` and `pycoingecko` for accessing the Google Sheets and CoinGecko APIs

I establish credentials for logging into my Google account:


Next, the script imports some cells from the Google Sheet that has the existing price data in it.

The script takes the list of currency codes from the sheet and queries the CoinGecko API for the current bitcoin price in all those currencies.

Compute today's date:

Update the pandas dataframe with the latest price data:

Next, I compare the existing ATH prices with today's prices, to see whether the latest prices are the highest ever. If a new price is the ATH, it is replaces the old price in the datframe.

Finally, the updated dataframe is sent to the Google Sheet and overrides the existing data.


Next, I extended the script to write the results to a public Google Sheet, using the Sheets API. Finally, I automated the script using AWS Lambda. The script now runs every ten minutes with no input from me.

Let's walk through the final script, as it looks in the AWS Lambda system:

### AWS Lambda
Lambda is an AWS service that lets you run code without having to deal with servers: you just give Amazon your code and they deal with everything. There is a generous free teir, so I do not pay anything to have this script running.
